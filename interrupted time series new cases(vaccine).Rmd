```{r}
library(dplyr)
library(ggplot2)
library(tidyverse)
library(lubridate)
setwd("~/GitHub/Internship")
covid_data <- read_csv('https://covid.ourworldindata.org/data/owid-covid-data.csv')
```

```{r}
UK_covid_data<- UK_covid_data%>%
  filter(UK_covid_data$date>= "2020-02-03")
UK_covid_data2<- UK_covid_data
UK_covid_data2$week_no.<- as.integer(as.duration("2020-02-03"%--%UK_covid_data$date)/dweeks(1))
as.duration("2020-02-03"%--%"2020-12-08")/dweeks(1)
UK_covid_data2<- UK_covid_data2%>%
  group_by(week_no.)%>%
  summarise(avg_new_cases= mean(new_cases))%>%
  mutate(week_no.= week_no., change= ifelse(week_no.>=45, 1, 0))
UK_covid_data2$vaccine_week<- ifelse(UK_covid_data2$week_no.> 45, 1, 0)

UK_covid_data2$vaccine_week<- UK_covid_data2$week_no.-45
UK_covid_data2$weekpostchange<- UK_covid_data2$change * UK_covid_data2$vaccine_week
UK_covid_data2$change<- as.factor(UK_covid_data2$change)
UK_covid_data2$week_no.<- UK_covid_data2$week_no.+1
```
```{r}
UK_covid_data$week.beg<- ceiling_date(UK_covid_data$date, unit = "week", week_start = 1)
UK_covid_data$week.beg<- group_by(UK_covid_data, week.beg)
week.beg<- summarise(UK_covid_data$week.beg)
week.begin<- pull(week.beg)
class(week.begin)
```
modelling
```{r}

```


```{r}
ggplot(UK_covid_data2, aes(week.begin, avg_new_cases, colour= change))+
  geom_point()+
  geom_line()+
  scale_y_continuous()+
  scale_x_date(date_breaks = "1 week", date_labels = "%d-%m-%y")+
  geom_vline(xintercept = "2020-12-08")+
  annotate("text", x= "2020-12-08", y= 60000, label= "Vaccine(8Dec)", angle= 90, size= 2, linetype= 2, colour= grey)+
  labs(title = "UK New Cases", x= "Week", y= "Confimed new cases")+
  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
ggsave("interrupted time series new cases(vaccine).png")
```
Safia: I've managed to get the week beginning but when I try to plot it says "Error: Invalid input: date_trans works with objects of class Date only"


